<!DOCTYPE html>
<html lang="en" class="min-h-full">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Robin Martijn</title>

    <!-- Styles -->
    <link href="http://localhost/css/app.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-gray-800 to-black min-h-full">

<div class="text-gray-300 container mx-auto p-8 overflow-hidden md:rounded-lg md:px-10 lg:px-12 py-32 md:py-40">
        <h1 class="font-sans text-4xl font-bold text-gray-200 max-w-5xl lg:text-7xl lg:pr-24 md:text-6xl">
            How I built this blog without a single database
        </h1>
        <h2 class="font-sans text-2xl font-bold text-gray-400 max-w-5xl lg:text-5xl lg:pr-24 md:text-4xl mt-8">
            Stealing the Jekyll way
        </h2>
        <div class="mt-8">
            <p class="text-gray-400 font-sans text-xl md:text-3xl">
                27 April 2022
            </p>
        </div>

        <div class="container max-w-4xl">
            <div class="mt-16 md:mt-16 lg:mt-24"><p>This is not the first time I have started a blog. Nor the second time. Probably not the tenth time either. And it won't be the last time either. I don't know why I start a blog so often. I guess I'm too perfectionist for it.</p>
<p>I have used several blogging platforms, such as <a href="https://wordpress.com/">WordPress</a> and <a href="https://hashnode.com/">Hashnode</a>, but this time I created my own blogging platform. A platform is probably too big a word. It's a (very) simple Laravel application that displays Markdown files. That's it.</p>
<p>The application has no database, only a directory of markdown files. This makes it much easier and more approachable for me to write than a full platform. The result? Hopefully, I'll actually write more.</p>
<p>One of the things about existing platforms is that code is hard to use. It works with vague plugins that have poor support for modern techniques, or it just looks ugly. I don't understand any of that. How can this be so difficult?</p>
<p>In this blog post, I will discuss how I wrote this blog. In doing so, I have chosen to include certain excerpts. The full application - which is obviously ongoing - [can be found on my GitHub]((https://github.com/Bowero/blog).</p>
<h1 id="creating-a-custom-command-to-create-new-posts">Creating a custom command to create new posts</h1>
<p>So, I decided I wanted to work with Markdown files. This also immediately eliminated the need to use another database. I can just loop over the Markdown files and parse them. This is also the way <a href="https://jekyllrb.com/">Jekyll</a> works.</p>
<p>I started by creating a new Laravel project with Composer.</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">$ composer create-project laravel/laravel blog</span></span>
<span class="line"></span></code></pre>
<p>My first step in this new project, was to set up a <code>Command</code> to be able to create new posts. For this I also needed a stub.</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #E06C75"># storage/templates/post.md</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">title: {{title}}</span></span>
<span class="line"><span style="color: #ABB2BF">subtitle: {{subtitle}}</span></span>
<span class="line"><span style="color: #ABB2BF">date: {{date}}</span></span>
<span class="line"><span style="color: #ABB2BF">published: false</span></span>
<span class="line"><span style="color: #E06C75">---</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">{{title}}</span></span>
<span class="line"></span></code></pre>
<p>At the top of this file I have some metadata. For now, I have chosen to keep this as simple as possible. For the record, I decided at 11pm that I wanted to develop this, and I wanted to get to bed a little early. As I write this, it's 1am, so that worked out well.</p>
<p>The next part was writing the command itself. Again, this became a simple implementation. I ask two questions: the title of the article and the subtitle. The date and time, of course, I can determine automatically. Based on this data I can fill in the stub and create the file in <code>storage/posts</code>.</p>
<p>The command is as follows.</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #56B6C2">&lt;</span><span style="color: #C678DD">?</span><span style="color: #ABB2BF">php</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">namespace</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">App\Console\Commands</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">use</span><span style="color: #ABB2BF"> Illuminate\Console\</span><span style="color: #E5C07B">Command</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">use</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Str</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">CreateNewPostCommand</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">extends</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Command</span></span>
<span class="line"><span style="color: #ABB2BF">{</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">protected</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">$signature</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;post:new&#39;</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">protected</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">$description</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;Create a new post&#39;</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">public</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">handle</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$this</span><span style="color: #ABB2BF">-&gt;</span><span style="color: #61AFEF">ask</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;What is the title of the post?&#39;</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$subtitle</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$this</span><span style="color: #ABB2BF">-&gt;</span><span style="color: #61AFEF">ask</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;What is the subtitle of the post?&#39;</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$date</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">date</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;Y-m-d&#39;</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$title_slug</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Str</span><span style="color: #ABB2BF">::</span><span style="color: #61AFEF">slug</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$title</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #7F848E; font-style: italic">// Create a new file in storage/posts/</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$filename</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">date</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;Y-m-d-H-i-s&#39;</span><span style="color: #ABB2BF">) </span><span style="color: #ABB2BF">.</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;-&#39;</span><span style="color: #ABB2BF"> </span><span style="color: #ABB2BF">.</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">$title_slug</span><span style="color: #ABB2BF"> </span><span style="color: #ABB2BF">.</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;.md&#39;</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$filepath</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">storage_path</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;posts/&#39;</span><span style="color: #61AFEF"> </span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$filename</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #7F848E; font-style: italic">// Create the file from the template in storage/templates/post.md</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">file_get_contents</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">storage_path</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;templates/post.md&#39;</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">str_replace</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;{{title}}&#39;</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$title</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">str_replace</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;{{subtitle}}&#39;</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$subtitle</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">str_replace</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;{{date}}&#39;</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$date</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #56B6C2">file_put_contents</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$filepath</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$template</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #7F848E; font-style: italic">// Tell the user what happened</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">$this</span><span style="color: #ABB2BF">-&gt;</span><span style="color: #61AFEF">info</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&quot;Created </span><span style="color: #E06C75">$filepath</span><span style="color: #98C379">&quot;</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h1 id="fetching-all-posts">Fetching all posts</h1>
<p>The next step, of course, was to retrieve all the files. There is no pagination of any kind on it for now. This is just an MVP. That means that large amounts of blog posts can become very tedious at this point. That's a nice problem for another time.</p>
<p>I do the fetching of files with the built-in Laravel <code>File</code> model. I have not created any models for this application myself. In fact, I have removed the default <code>User</code> model.</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #E06C75">$posts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">collect</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #61AFEF">        </span><span style="color: #E5C07B">File</span><span style="color: #ABB2BF">::</span><span style="color: #61AFEF">allFiles</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">storage_path</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;posts&#39;</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #61AFEF">    </span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span></code></pre>
<p>Now that we have the files, we need to loop over them to extract the metadata. We need these to show an overview of posts on the home page.</p>
<p>This also shows one of the disadvantages of this system: you have to open all the files every time. Of course, you can cache this, but hey, this is only an MVP. In a future post, I will discuss caching.</p>
<p>So now that we have all the posts, we need to get the metadata. We also need to cast these in order to actually get something out of them. The result of this looks like this.</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #E06C75">$posts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">collect</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #61AFEF">        </span><span style="color: #E5C07B">File</span><span style="color: #ABB2BF">::</span><span style="color: #61AFEF">allFiles</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">storage_path</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;posts&#39;</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #61AFEF">    </span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        -&gt;</span><span style="color: #61AFEF">reverse</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">        -&gt;</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">$file</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #7F848E; font-style: italic">// Get the file contents</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #E06C75">$contents</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">File</span><span style="color: #ABB2BF">::</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$file</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #7F848E; font-style: italic">// Set $path to the path of the file without .md</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #E06C75">$path</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">str_replace</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;.md&#39;</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #98C379">&#39;&#39;</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$file</span><span style="color: #ABB2BF">-&gt;</span><span style="color: #61AFEF">getRelativePathname</span><span style="color: #ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #7F848E; font-style: italic">// Get the metadata from the contents of the file</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #E06C75">$metadata</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">substr</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$contents</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #56B6C2">strpos</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$contents</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #98C379">&#39;---&#39;</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #E06C75">$metadata</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">collect</span><span style="color: #ABB2BF">(</span><span style="color: #56B6C2">explode</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&quot;</span><span style="color: #E5C07B">\n</span><span style="color: #98C379">&quot;</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$metadata</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #ABB2BF">                -&gt;</span><span style="color: #61AFEF">filter</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">$line</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">                    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">empty</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$line</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">                })</span></span>
<span class="line"><span style="color: #ABB2BF">                -&gt;</span><span style="color: #61AFEF">mapWithKeys</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">$item</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">                    </span><span style="color: #56B6C2">list</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$key</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$value</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">explode</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&#39;:&#39;</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #E06C75">$item</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">                    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> [</span><span style="color: #56B6C2">trim</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$key</span><span style="color: #ABB2BF">) =&gt; </span><span style="color: #56B6C2">trim</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$value</span><span style="color: #ABB2BF">)];</span></span>
<span class="line"><span style="color: #ABB2BF">                })</span></span>
<span class="line"><span style="color: #ABB2BF">                -&gt;</span><span style="color: #61AFEF">all</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #98C379">&#39;path&#39;</span><span style="color: #ABB2BF"> =&gt; </span><span style="color: #E06C75">$path</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #98C379">&#39;title&#39;</span><span style="color: #ABB2BF"> =&gt; </span><span style="color: #E06C75">$metadata</span><span style="color: #ABB2BF">[</span><span style="color: #98C379">&#39;title&#39;</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #98C379">&#39;subtitle&#39;</span><span style="color: #ABB2BF"> =&gt; </span><span style="color: #E06C75">$metadata</span><span style="color: #ABB2BF">[</span><span style="color: #98C379">&#39;subtitle&#39;</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #98C379">&#39;published&#39;</span><span style="color: #ABB2BF"> =&gt; </span><span style="color: #E06C75">$metadata</span><span style="color: #ABB2BF">[</span><span style="color: #98C379">&#39;published&#39;</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">                </span><span style="color: #98C379">&#39;date&#39;</span><span style="color: #ABB2BF"> =&gt; </span><span style="color: #E5C07B">Carbon</span><span style="color: #ABB2BF">::</span><span style="color: #61AFEF">parse</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$metadata</span><span style="color: #ABB2BF">[</span><span style="color: #98C379">&#39;date&#39;</span><span style="color: #ABB2BF">])</span></span>
<span class="line"><span style="color: #ABB2BF">            ];</span></span>
<span class="line"><span style="color: #ABB2BF">        })</span></span>
<span class="line"><span style="color: #ABB2BF">        -&gt;</span><span style="color: #61AFEF">filter</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">$post</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">$post</span><span style="color: #ABB2BF">[</span><span style="color: #98C379">&#39;published&#39;</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">&#39;true&#39;</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">        });</span></span>
<span class="line"></span></code></pre>
<p>Yes, there is certainly something to be said for this code. Feel free to <a href="https://twitter.com/RobinMartijn">tweet at me with suggestions</a>!</p>
<h1 id="showing-a-single-post">Showing a single post</h1>
<p>Now that we have an overview of all posts, we still need to be able to retrieve a single post. I chose to use the filename as a slug in the URL. So an endpoint is, for example:</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #56B6C2">/</span><span style="color: #ABB2BF">posts</span><span style="color: #56B6C2">/</span><span style="color: #D19A66">2022</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">04</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">26</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">22</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">39</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">27</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">how</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">i</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">built</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">this</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">blog</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">without</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">a</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">single</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">database</span></span>
<span class="line"></span></code></pre>
<p>You're reading that one right now!</p>
<p>Therefore, retrieving such a post is not very complicated. Now that we know the filename, we can retrieve the contents of the file directly from the file.</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #E06C75">$contents</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">File</span><span style="color: #ABB2BF">::</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">storage_path</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">&quot;posts/</span><span style="color: #E06C75">$path</span><span style="color: #98C379">.md&quot;</span><span style="color: #ABB2BF">));</span></span>
<span class="line"></span></code></pre>
<p>The retrieval of the metadata we have also covered, and is actually identical to the way we do it when retrieving multiple files. Now we also need the Markdown content, however.</p>
<p>Fortunately, that's not exciting.</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #E06C75">$content</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">substr</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$contents</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #56B6C2">strpos</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">$contents</span><span style="color: #ABB2BF">,</span><span style="color: #61AFEF"> </span><span style="color: #98C379">&#39;---&#39;</span><span style="color: #ABB2BF">)</span><span style="color: #61AFEF"> </span><span style="color: #56B6C2">+</span><span style="color: #61AFEF"> </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span></code></pre>
<p>The more interesting part is how we then parse the Markdown into correct HTML. At least, it should be. Unfortunately, the gentlemen at Spatie have made that boring for us too.</p>
<p>I am using <a href="https://spatie.be/docs/laravel-markdown/v1/introduction"><code>Laravel-markdown</code></a>, a package from Spatie. Installation of the package is tremendously straightforward:</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">$ composer require spatie/laravel-markdown</span></span>
<span class="line"></span></code></pre>
<p>Its use is at least as simple:</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">&lt;</span><span style="color: #E06C75">x-markdown</span><span style="color: #ABB2BF">&gt;</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #56B6C2">{!!</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">$content</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!!}</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;/</span><span style="color: #E06C75">x-markdown</span><span style="color: #ABB2BF">&gt;</span></span>
<span class="line"></span></code></pre>
<p>All that is left then is to design the website itself.</p>
<h1 id="everything-is-tailwind">Everything is Tailwind</h1>
<p>I have not written any custom CSS. Everything you're looking at now is standard, out of the box, Tailwind. Installation of Tailwind on Laravel is incredibly easy and in many cases already done for you (for example, if you use Laravel Jetstream).</p>
<p>There were some styles I had to `@apply' because the HTML that came out of Markdown was not as nice as the rest of my outstanding design skills.</p>
<p>I did this by assigning additional styles to the HTML tags in the app.css:</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #C678DD">@tailwind</span><span style="color: #ABB2BF"> base;</span></span>
<span class="line"><span style="color: #C678DD">@tailwind</span><span style="color: #ABB2BF"> components;</span></span>
<span class="line"><span style="color: #C678DD">@tailwind</span><span style="color: #ABB2BF"> utilities;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">@layer</span><span style="color: #ABB2BF"> base {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">body</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply text-xl md:text-2xl;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">p</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply mb-8;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">ol</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply mb-8 list-decimal pl-5;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">ul</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply mb-8 list-disc pl-5;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">pre</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply mb-8 p-5 overflow-x-auto text-lg;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">a</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply underline;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">h1</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply text-4xl md:text-5xl font-bold mb-8 mt-16;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">h2</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply text-3xl md:text-4xl font-bold mb-8 mt-16;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">h3</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply text-2xl md:text-3xl font-bold mb-8 mt-16;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">h4</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        @apply text-xl md:text-2xl font-bold mb-8 mt-16;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<p>Don't forget to compile this yet!</p>
<pre class="shiki" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">$ npm run dev</span></span>
<span class="line"></span></code></pre>
<p>And voil√†! The result is the website (and blog post) you're looking at now!</p>
<h1 id="there-is-still-a-lot-to-be-done">There is still a lot to be done</h1>
<p>This application was created in 2 hours and it took me almost longer to write this blog post than it took me to write the application. As a result, there are still many things I didn't do.</p>
<p>One important one I already mentioned is caching the blog posts. Once a post is published, it's not likely to change again anytime soon, much less regularly.</p>
<p>Something else is that you can't go back to my homepage now that you've finished reading. I couldn't figure this out quickly design-wise, so I chose to leave it out.</p>
<p><a href="/">If you still want to go back, you can click here.</a></p>
<p>However, these are things I will play with over time. This project is for my personal use only. If you want to publish a blog with it yourself: feel free! If you just want to look at the code to learn something from it, or to be able to criticize me on Twitter: <a href="https://github.com/Bowero/blog">it's on GitHub</a>.</p>
</div>
        </div>
    </div>

</body>
</html>
